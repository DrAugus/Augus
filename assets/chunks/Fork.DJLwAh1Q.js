import{d as v,G as A,r as E,l as R,m as b,n as H,p as N,q as y,s as j,t as _,g as L}from"./utils.D0TYFXdU.js";import"./zh.sXGPeAhE.js";import{_ as k,o as c,c as h,j as r,a as T,a6 as I,a7 as D,F as f,C as g,t as m,e as O}from"./framework.DsEWC0co.js";v.locale("zh");const S={name:"Fork",data(){return{sliceCharZH:[],displayRes:[],selectedLastChar:"",selectedFork:""}},props:{WISH:{type:Object,required:!0},CHARACTER:{type:Object,required:!0},GAME_NAME:{type:Number,required:!0,default:A.Genshin}},methods:{sortLast(){this.displayRes=this.displayRes.sort((o,e)=>o.tag-e.tag)},sortEarly(){this.displayRes=this.displayRes.sort((o,e)=>e.tag-o.tag)},getSelectDuration(o){let e=this.displayRes.find(l=>l.nameZH===o);return e?e.duration:"未找到"},replaceImg(o){o.target.src="/image/genshin/characters/paimon_faq.png"}},async mounted(){const o=Object.values(this.CHARACTER).filter(s=>s.star===5).map(s=>s.id);Object.values(this.CHARACTER).filter(s=>s.star===4).map(s=>s.id);const e=o.map(s=>this.CHARACTER[E(s)].name);this.sliceCharZH=e;let l={};(s=>{for(let t of s){l[t]=[];for(let d of this.WISH.characters){let p=d.wish5star.indexOf(t);if(p!==-1){let u={};u.name=d.name[p],u.image=d.image[p],u.shortName=d.wish5star[p],u.start=d.start,u.end=d.end,u.version=d.version,l[t].push(u)}}}})(o),l=R(l,s=>s.length),Object.values(l).forEach(function(s){Array.isArray(s)&&s.sort((t,d)=>d.image-t.image)});let i=[];Object.values(l).forEach(s=>{i.push(s[0])}),i=i.sort((s,t)=>b(s.end,t.end));for(let s of i)H(s.start,s.end)?s.duration=0:N(s.end)?s.duration=y(s.end):j(s.start)&&(s.duration=y(s.start));const n=s=>{let t="";return s>0?t=` ${parseInt(s)}天后登场`:s<0?t=` 距今${-parseInt(s)}天`:t=` 当前${L(this.GAME_NAME)}进行时`,t};let a=[];for(let s of i){let t={};t.shortName=s.shortName,t.nameZH=this.CHARACTER[s.shortName].name,t.src=_(this.GAME_NAME,s.shortName),t.version=s.version,t.duration=n(s.duration),t.tag=s.duration,a.push(t)}this.displayRes=a,this.selectedFork="",this.selectedLastChar="",this.sortEarly()}},F={key:0,class:"choose"},M={class:"underline"},W={class:"char-container"},Z={class:"char-avatar"},x=["src"],G={class:"char-info"},q={class:"char-name"},w={class:"char-version"},V={class:"char-duration"};function B(o,e,l,C,i,n){return c(),h(f,null,[r("a",{onClick:e[0]||(e[0]=(...a)=>n.sortLast&&n.sortLast(...a))},"最近排序"),e[6]||(e[6]=T(" | ")),r("a",{onClick:e[1]||(e[1]=(...a)=>n.sortEarly&&n.sortEarly(...a))},"最远排序"),e[7]||(e[7]=r("br",null,null,-1)),e[8]||(e[8]=r("br",null,null,-1)),I(r("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>i.selectedLastChar=a)},[e[4]||(e[4]=r("option",{disabled:"",value:""},"选择角色",-1)),(c(!0),h(f,null,g(i.sliceCharZH,(a,s)=>(c(),h("option",null,m(a),1))),256))],512),[[D,i.selectedLastChar]]),i.selectedLastChar?(c(),h("p",F,[r("strong",null,m(i.selectedLastChar+" "),1),r("span",M,[r("span",null,m(n.getSelectDuration(i.selectedLastChar)),1)]),e[5]||(e[5]=r("br",null,null,-1))])):O("",!0),e[9]||(e[9]=r("hr",null,null,-1)),r("div",null,[(c(!0),h(f,null,g(i.displayRes,(a,s)=>(c(),h("div",{key:s},[r("div",W,[r("div",Z,[r("img",{src:a.src,onError:e[3]||(e[3]=(...t)=>n.replaceImg&&n.replaceImg(...t))},null,40,x)]),r("div",G,[r("div",q,m(a.nameZH),1),r("div",w,m("ver"+a.version),1),r("div",V,m(a.duration),1)])])]))),128))])],64)}const K=k(S,[["render",B],["__scopeId","data-v-79fd7f8a"]]);export{K as F};
